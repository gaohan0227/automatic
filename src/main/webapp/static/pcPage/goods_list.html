<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="format-detection" content="email=no" />
    <meta name="format-detection" content="address=no" />
    <meta name="format-detection" content="date=no" />
    <title>商品展示</title>
    <link href="../../css/api.css" rel="stylesheet" type="text/css">
    <link href="../../css/aui.css" rel="stylesheet" type="text/css">
    <link href="../../css/index.css" rel="stylesheet" type="text/css">
    <style>
        .goods_list {
            display: flex;
            flex-wrap: wrap;
        }

        .goods_list .goods_item {
            width: 50%;
            height: 9.9rem;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 0;
        }

        .goods_list .goods_item:nth-child(2n+1):before {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            width: 1px;
            background: #eaeaea;
            transform: scaleX(0.5);
            -webkit-transform: scaleX(0.5);
            transform-origin: 0 0;
            -webkit-transform-origin: 0 0;
        }

        .goods_list .goods_item:after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: #eaeaea;
            transform: scaleY(0.5);
            -webkit-transform: scaleY(0.5);
            transform-origin: 0 0;
            -webkit-transform-origin: 0 0;
        }

        .goods_item .goods_item_img {
            width: 5.4rem;
            margin: 0 auto;
            position: relative;
        }

        .goods_item .goods_item_img:before {
            content: "";
            padding-top: 100%;
            background: url(../../image/no_page/goods.png) no-repeat;
            background-size: 100% 100%;
            display: block;
            border-radius: 0.1rem;
        }

        .goods_item .goods_item_img img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0.1rem;
        }

        .goods_item p {
            padding: 0 0.5rem;
            padding-top: 0.35rem;
            line-height: 1rem;
            color: #ACACAC;
            font-size: 0.65rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .goods_item p.goods_name {
            padding-top: 0.55rem;
            line-height: 1.1rem;
            color: #2F2F2F;
            font-size: 0.8rem;
        }

        .goods_item p span {
            font-size: 0.75rem;
            color: #FE4973;
            padding-right:0.2rem;
        }
    </style>
</head>

<body>
    <div class="vueApp" v-cloak>
        <div class="goods_list" v-if="isLoad">
            <div class="goods_item" v-for="item in listData">
                <div class="goods_item_img">
                    <img :src="item.goodsPicture" alt="">
                </div>
                <p class="goods_name">{{item.goodsName}}</p>
                <p><span>{{item.goodsNum}}</span>积分</p>
            </div>
            <div class="none_data" v-if="listData.length==0">
                <div>
                    <img src="../../image/no_page/no_goods.png" alt="">
                </div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/vue.min.js"></script>
<script type="text/javascript" src="../../script/service/service-app.js"></script>
<script type="text/javascript" src="../../script/service/service-tool.js"></script>
<script type="text/javascript" src="../../script/service/service-font.js"></script>
<script type="text/javascript" src="../../script/service/service-user.js"></script>
<script type="text/javascript" src="../../script/service/service-login.js"></script>
<script type="text/javascript" src="../../script/service/service-verify.js"></script>
<script type="text/javascript">
    var $S, USER;
    var vm;
    apiready = function() {
        $S = SERVICE();
        USER = USER();
        fnInit();
        fnInitPage();
    }

    function fnInit() {
        vm = new Vue({
            el: ".vueApp",
            data: {
                listData: [],
                isLoad:false,
                pageNo:1
            }
        })
    }
    function fnInitPage() {
        fnGetGoodsList();
        fnAddHeaderRefreshingEvent(function() { //设置下拉刷新
            fnGetGoodsList('headerRefreshing');
        });

        fnAddFooterLoadingEvent(function() { // 设置上拉加载
            fnGetGoodsList('load');
        });

    }

    function fnGetGoodsList(pSign) {
        if (pSign != "load") { //刷新
            if (pSign != "headerRefreshing") {
                $S.ShowProgress();
            }
            vm.pageNo = 1;
        } else { //加载
            $S.ShowProgress();
        }
        var postData = {
            "pageNo": vm.pageNo,
            "pageSize": "10"
        }
        $S.POST("apiTeacherLogin/findGoodsList", postData, function(ret, err) {
            if (ret && ret.status == "200") {
                if (vm.pageNo == '1') {
                    vm.listData = [];
                }
                vm.listData.push.apply(vm.listData, ret.data.listData);
                vm.pageNo++;
            }
            $S.CloseProgress();
            api.refreshHeaderLoadDone();
            vm.isLoad = true;
        })
    }
</script>

</html>
