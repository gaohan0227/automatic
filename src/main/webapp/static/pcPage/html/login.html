<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../css/index.css">
	<script type="text/javascript" src="../libs/jquery.min.js"></script>
	<script type="text/javascript" src="../libs/bootstrap.min.js"></script>
	<script type="text/javascript" src="../js/page.js"></script>
	<script type="text/javascript" src="../js/tool.js"></script>
	<script type="text/javascript" src="../js/pageInit.js"></script>
	<title>登录</title>
	<style>
		html,
		body {
			width: 100%;
			height: 100%;
		}

		.login {
			position: relative;
			background: #47ACE2;
			width: 100%;
			min-height: 100%;
		}

		.login .login_top {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: auto;
			z-index: 9;
		}

		.login .login_bottom {
			position: absolute;
			bottom: 0;
			left: 0;
			width: 100%;
			height: auto;
			z-index: 9;
		}

		.login .login_left {
			position: absolute;
			bottom: 0;
			left: 17.45%;
			/* width: auto;
            height: 59.54%; */
			width: 36.51%;
			height: auto;
			z-index: 999;
		}

		.login .login_header_left {
			position: absolute;
			top: 8.43vw;
			left: 13.6%;
			width: 7.674%;
			height: auto;
			z-index: 99;
		}

		.login .login_header_right {
			position: absolute;
			top: 10.17vw;
			left: 37.8%;
			width: 44.94%;
			height: auto;
			z-index: 99;
		}

		.login .login_div {
			padding-top: 23.08vw;
			padding-bottom: 16.8vw;
			padding-left: 55.93%;
			width: 100%;
			height: 100%;
		}

		.login .login_div .login_input {
			position: relative;
			width: 27.91vw;
			height: auto;
			padding: 2.91vw 3.49vw;
			font-size: 1.05vw;
			color: #2F2F2F;
			z-index: 9999;
			background: #fff;
			box-shadow: 0px 8px 16px -10px rgba(0, 0, 0, 0.06);
			border-radius: 10px;
			border: 0.23vw solid rgba(206, 207, 209, 1);
		}

		.login_input .login_input_top {
			position: absolute;
			top: -1.40vw;
			right: -2.03vw;
			width: 5.23vw;
			height: auto;
			z-index: 99999;
		}

		.login_input .login_input_title {
			display: flex;
			align-items: center;
		}

		.login_input .login_input_title img {
			width: 5.81vw;
			margin-right: 1.28vw;
		}

		.login_input .login_input_title span {
			flex: 1;
			padding: 0 1.51vw;
			height: 1.28vw;
			line-height: 1.28vw;
			border-left: 1px solid #6D6D6D;
			font-size: 1.16vw;
		}

		.login_input input {
			outline: none;
			height: 2.91vw;
			width: 100%;
			padding: 0 1.57vw;
			line-height: 2.91vw;
			border-radius: 1.45vw;
			border: 1px solid rgba(234, 234, 234, 1);
			color: #2F2F2F;
			font-weight: bold;
		}

		.login_input input::-webkit-input-placeholder {
			color: #D5D5D5;
		}

		.login_input input:-moz-placeholder {
			color: #D5D5D5;
		}

		.login_input input::-moz-placeholder {
			color: #D5D5D5;
		}

		.login_input input:-ms-input-placeholder {
			color: #D5D5D5;
		}

		.login_input .tel_input {
			padding-top: 2.32vw;
		}

		.login_input .code_input {
			padding-top: 1.16vw;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.login_input .code_input input {
			flex: 1;
		}

		.login_input .code_input span {
			height: 2.91vw;
			line-height: 2.91vw;
			margin-left: 0.58vw;
			width: 6.63vw;
			text-align: center;
			background: rgba(255, 212, 70, 1);
			border-radius: 1.45vw;
		}

		.login_input .code_input span.gray_bg {
			background: #EAEAEA;
		}

		.login_input .login_btn {
			margin-top: 1.16vw;
			height: 2.91vw;
			line-height: 2.91vw;
			text-align: center;
			width: 100%;
			background: rgba(255, 212, 70, 1);
			border-radius: 1.45vw;
			opacity: 0.5;
		}

		.login_input .login_btn.login_btn_opacity {
			opacity: 1;
		}
	</style>
</head>

<body>
	<div class="login" v-cloak>
		<img class="login_top" src="../img/login/login_top.png" alt="">
		<img class="login_header_left" src="../img/login/login_header_left.png" alt="">
		<img class="login_header_right" src="../img/login/login_header_right.png" alt="">
		<img class="login_left" src="../img/login/login_left.png" alt="">
		<img class="login_bottom" src="../img/login/login_bottom.png" alt="">
		<div class="login_div">
			<div class="login_input" id="login">
				<img class="login_input_top" src="../img/login/login_input_top.png" alt="">
				<div class="login_input_title">
					<img src="../img/login/login_logo.png" alt="">
					<span>手机号登录</span>
				</div>
				<div class="tel_input" id="login_tel">
					<input type="text" v-model="telephone" maxlength="11" onkeyup="value=value.replace(/[^\d]/g,'')"
						data-type="_telphone" data-verify="true" data-null="true" data-regular="true" name="手机号"
						placeholder="手机号" />
				</div>
				<div class="code_input">
					<input type="text" v-model="verify_code" maxlength="6" onkeyup="value=value.replace(/[^\d]/g,'')"
						data-type="_code" data-verify="true" data-null="true" data-regular="true" name="验证码"
						placeholder="验证码" />
					<span :class="isSendCode?'':'gray_bg'" @click="isSendCode?fnGetCode():''">{{sendBtnText}}</span>
				</div>
				<div :class="isAvailable?'login_btn login_btn_opacity':'login_btn'" @click="isAvailable?fnLogin():''">
					登录/注册</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" src="../js/vue.min.js"></script>
<script type="text/javascript" src="../js/service/service-tool.js"></script>
<script type="text/javascript" src="../js/service/service-verify.js"></script>
<script type="text/javascript">
	var loginVm;
	window.onload = function () {
		var _studentId = localStorage.custId || "";
		if (_studentId != '') {
			window.location.href = 'http://' + window.location.host + '/FutureEducation/static/pcPage/html/index.html';
		} else {
			fnInit();
		}
	}

	function fnInit() {
		loginVm = new Vue({
			el: ".login",
			data: {
				telephone: "",
				verify_code: "",
				isAvailable: false, //登陆按钮是否可用
				sendBtnText: "验证码",
				isSendCode: true
			},
			methods: {
				fnGetCode: function () {
					fnGetVerifyCode()
				}
			},
			watch: { //监听手机号和密码的值，来判断开启和关闭登陆按钮的点击状态
				telephone: function telephone() {
					fnLoginBtnStatus(this);
				},
				verify_code: function verify_code() {
					fnLoginBtnStatus(this);
				}
			}
		})
	}
	//修改登录按钮的启用状态
	function fnLoginBtnStatus(el) {
		if (!isEmpty(loginVm.telephone) && !isEmpty(loginVm.verify_code)) {
			loginVm.isAvailable = true;
		} else {
			loginVm.isAvailable = false;
		}
	};

	function fnLogin() {
		if (!fnVerify("login")) {
			return;
		}
		var postData = {
			"telephoneNum": loginVm.telephone,
			"code": loginVm.verify_code
		};
		var callback = function (ret) {
			if (ret && ret.status == "200") {
				fnToast("登录成功");
				fnWhenLoginSucess(ret.data);
				window.location.href = 'http://' + window.location.host + '/FutureEducation/static/pcPage/html/index.html';
			}
		}
		POST('apiTeacherLogin/studentInfoLogin', postData, callback);

	}
	//获取验证码
	function fnGetVerifyCode() {
		if (!fnVerify("login_tel")) {
			return;
		}
		var postData = {
			"telephoneNum": loginVm.telephone,
			"kind": '0' //0:登录 1:原手机号 2:新手机号
		}
		var callback = function (ret) {
			if (ret && ret.status == "200") {
				fnToast("验证码发送成功");
				loginVm.isSendCode = false;
				fnVerifyTime('60', loginVm);
			}
		}
		POST('apiTeacherLogin/sendCode', postData, callback);
	}
</script>

</html>